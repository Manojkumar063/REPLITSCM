{% extends "base.html" %}

{% block title %}Dashboard - SCMXPertLite{% endblock %}

{% block content %}
<div class="dashboard-container">
    <div class="container-fluid">
        <!-- Dashboard Header -->
        <div class="dashboard-header">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="dashboard-title">
                        <i class="bi bi-speedometer2 me-3"></i>
                        Dashboard
                    </h1>
                    <p class="dashboard-subtitle">Welcome back, {{ user.username }}!</p>
                </div>
                <div class="col-lg-6 text-end">
                    <div class="dashboard-actions">
                        <button class="btn btn-premium-outline me-2">
                            <i class="bi bi-download me-2"></i>Export Report
                        </button>
                        <button class="btn btn-premium-primary">
                            <i class="bi bi-plus-circle me-2"></i>New Shipment
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="row g-4">
                <div class="col-lg-3 col-md-6">
                    <div class="stat-card premium-card">
                        <div class="stat-icon stat-primary">
                            <i class="bi bi-box-seam"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">{{ stats.total_shipments }}</h3>
                            <p class="stat-label">Total Shipments</p>
                            <div class="stat-change positive">
                                <i class="bi bi-arrow-up"></i>
                                <span>12% vs last month</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="stat-card premium-card">
                        <div class="stat-icon stat-success">
                            <i class="bi bi-truck"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">{{ stats.in_transit }}</h3>
                            <p class="stat-label">In Transit</p>
                            <div class="stat-change positive">
                                <i class="bi bi-arrow-up"></i>
                                <span>8% vs last month</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="stat-card premium-card">
                        <div class="stat-icon stat-info">
                            <i class="bi bi-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">{{ stats.delivered }}</h3>
                            <p class="stat-label">Delivered</p>
                            <div class="stat-change positive">
                                <i class="bi bi-arrow-up"></i>
                                <span>15% vs last month</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col-lg-3 col-md-6">
                    <div class="stat-card premium-card">
                        <div class="stat-icon stat-warning">
                            <i class="bi bi-cpu"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">{{ stats.active_devices }}</h3>
                            <p class="stat-label">Active Devices</p>
                            <div class="stat-change positive">
                                <i class="bi bi-arrow-up"></i>
                                <span>3% vs last month</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="row g-4 mt-4">
            <!-- Recent Shipments -->
            <div class="col-lg-8">
                <div class="premium-card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="bi bi-box-seam me-2"></i>
                            Recent Shipments
                        </h3>
                        <a href="{{ url_for('tracking') }}" class="btn btn-premium-outline btn-sm">
                            View All
                        </a>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table premium-table">
                                <thead>
                                    <tr>
                                        <th>Tracking #</th>
                                        <th>Route</th>
                                        <th>Status</th>
                                        <th>Priority</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for shipment in shipments %}
                                    <tr>
                                        <td>
                                            <span class="tracking-number">{{ shipment.tracking_number }}</span>
                                        </td>
                                        <td>
                                            <div class="route-info">
                                                <span class="route-origin">{{ shipment.origin }}</span>
                                                <i class="bi bi-arrow-right mx-2"></i>
                                                <span class="route-destination">{{ shipment.destination }}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <span class="status-badge status-{{ shipment.status.lower().replace(' ', '-') }}">
                                                {{ shipment.status }}
                                            </span>
                                        </td>
                                        <td>
                                            <span class="priority-badge priority-{{ shipment.priority.lower() }}">
                                                {{ shipment.priority }}
                                            </span>
                                        </td>
                                        <td>
                                            <div class="action-buttons">
                                                <button class="btn btn-sm btn-premium-outline">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                                <button class="btn btn-sm btn-premium-outline">
                                                    <i class="bi bi-geo-alt"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions & Alerts -->
            <div class="col-lg-4">
                <div class="premium-card mb-4">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="bi bi-lightning me-2"></i>
                            Quick Actions
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="quick-actions">
                            <a href="{{ url_for('tracking') }}" class="quick-action-item">
                                <i class="bi bi-plus-circle"></i>
                                <span>Create Shipment</span>
                            </a>
                            <a href="{{ url_for('analytics') }}" class="quick-action-item">
                                <i class="bi bi-bar-chart"></i>
                                <span>View Analytics</span>
                            </a>
                            <a href="{{ url_for('iot') }}" class="quick-action-item">
                                <i class="bi bi-cpu"></i>
                                <span>Manage Devices</span>
                            </a>
                        </div>
                    </div>
                </div>

                <div class="premium-card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <i class="bi bi-bell me-2"></i>
                            System Alerts
                        </h3>
                    </div>
                    <div class="card-body">
                        <div class="alert-item">
                            <div class="alert-icon alert-warning">
                                <i class="bi bi-exclamation-triangle"></i>
                            </div>
                            <div class="alert-content">
                                <h4>Device Battery Low</h4>
                                <p>GPS tracker IOT123 has 15% battery remaining</p>
                                <span class="alert-time">2 hours ago</span>
                            </div>
                        </div>
                        
                        <div class="alert-item">
                            <div class="alert-icon alert-info">
                                <i class="bi bi-info-circle"></i>
                            </div>
                            <div class="alert-content">
                                <h4>Shipment Delivered</h4>
                                <p>Shipment SCM12345678 delivered successfully</p>
                                <span class="alert-time">5 hours ago</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
