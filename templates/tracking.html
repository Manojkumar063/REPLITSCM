{% extends "base.html" %}

{% block title %}Tracking - SCMXPertLite{% endblock %}

{% block content %}
<div class="tracking-container">
    <div class="container-fluid">
        <!-- Tracking Header -->
        <div class="tracking-header">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h1 class="tracking-title">
                        <i class="bi bi-geo-alt me-3"></i>
                        Shipment Tracking
                    </h1>
                    <p class="tracking-subtitle">Real-time location and status updates</p>
                </div>
                <div class="col-lg-6 text-end">
                    <div class="tracking-search">
                        <div class="input-group">
                            <input type="text" class="form-control premium-input" placeholder="Search by tracking number...">
                            <button class="btn btn-premium-primary">
                                <i class="bi bi-search"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tracking Overview -->
        <div class="tracking-overview">
            <div class="row g-4">
                <div class="col-lg-3 col-md-6">
                    <div class="tracking-stat premium-card">
                        <div class="stat-icon stat-primary">
                            <i class="bi bi-truck"></i>
                        </div>
                        <div class="stat-content">
                            <h3>{{ shipments|selectattr('status', 'equalto', 'In Transit')|list|length }}</h3>
                            <p>In Transit</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="tracking-stat premium-card">
                        <div class="stat-icon stat-success">
                            <i class="bi bi-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3>{{ shipments|selectattr('status', 'equalto', 'Delivered')|list|length }}</h3>
                            <p>Delivered</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="tracking-stat premium-card">
                        <div class="stat-icon stat-warning">
                            <i class="bi bi-clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3>{{ shipments|selectattr('status', 'equalto', 'Delayed')|list|length }}</h3>
                            <p>Delayed</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <div class="tracking-stat premium-card">
                        <div class="stat-icon stat-info">
                            <i class="bi bi-box-seam"></i>
                        </div>
                        <div class="stat-content">
                            <h3>{{ shipments|length }}</h3>
                            <p>Total Shipments</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shipment List -->
        <div class="shipment-list">
            <div class="premium-card">
                <div class="card-header">
                    <h3 class="card-title">
                        <i class="bi bi-list-ul me-2"></i>
                        All Shipments
                    </h3>
                    <div class="card-actions">
                        <button class="btn btn-premium-outline btn-sm me-2">
                            <i class="bi bi-funnel me-2"></i>Filter
                        </button>
                        <button class="btn btn-premium-primary btn-sm">
                            <i class="bi bi-plus-circle me-2"></i>New Shipment
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="shipment-grid">
                        {% for shipment in shipments %}
                        <div class="shipment-card premium-card">
                            <div class="shipment-header">
                                <div class="shipment-id">
                                    <span class="tracking-number">{{ shipment.tracking_number }}</span>
                                    <span class="status-badge status-{{ shipment.status.lower().replace(' ', '-') }}">
                                        {{ shipment.status }}
                                    </span>
                                </div>
                                <div class="shipment-actions">
                                    <button class="btn btn-sm btn-premium-outline">
                                        <i class="bi bi-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-premium-outline">
                                        <i class="bi bi-geo-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="shipment-route">
                                <div class="route-point">
                                    <i class="bi bi-circle-fill origin-point"></i>
                                    <span>{{ shipment.origin }}</span>
                                </div>
                                <div class="route-line"></div>
                                <div class="route-point">
                                    <i class="bi bi-geo-alt-fill destination-point"></i>
                                    <span>{{ shipment.destination }}</span>
                                </div>
                            </div>
                            
                            <div class="shipment-details">
                                <div class="detail-item">
                                    <i class="bi bi-truck me-2"></i>
                                    <span>{{ shipment.carrier or 'Unknown' }}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="bi bi-calendar me-2"></i>
                                    <span>{{ shipment.estimated_delivery.strftime('%Y-%m-%d') if shipment.estimated_delivery else 'TBD' }}</span>
                                </div>
                                <div class="detail-item">
                                    <i class="bi bi-thermometer me-2"></i>
                                    <span>{{ shipment.temperature }}Â°C</span>
                                </div>
                            </div>
                            
                            <div class="shipment-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: {{ 
                                        '100%' if shipment.status == 'Delivered' else 
                                        '20%' if shipment.status == 'Delayed' else 
                                        '60%' 
                                    }}"></div>
                                </div>
                                <div class="progress-steps">
                                    <div class="step active">
                                        <i class="bi bi-box"></i>
                                        <span>Picked Up</span>
                                    </div>
                                    <div class="step {{ 'active' if shipment.status in ['In Transit', 'Delivered'] else '' }}">
                                        <i class="bi bi-truck"></i>
                                        <span>In Transit</span>
                                    </div>
                                    <div class="step {{ 'active' if shipment.status == 'Delivered' else '' }}">
                                        <i class="bi bi-check-circle"></i>
                                        <span>Delivered</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/tracking.js') }}"></script>
{% endblock %}
